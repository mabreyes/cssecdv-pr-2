<%- include('layout', { title: 'Register' }) %>

<h1>Register</h1>

<form action="/register" method="POST" autocomplete="off">
    <div>
        <label for="username">Username:</label>
        <input 
            type="text" 
            id="username" 
            name="username" 
            required 
            minlength="3" 
            maxlength="30" 
            pattern="[a-zA-Z0-9_-]+"
            title="Username must be 3-30 characters long and can only contain letters, numbers, hyphens, and underscores"
        >
        <small>3-30 characters, letters, numbers, hyphens, and underscores only</small>
    </div>

    <div>
        <label for="email">Email:</label>
        <input 
            type="email" 
            id="email" 
            name="email" 
            required 
            maxlength="320"
            autocomplete="email"
        >
    </div>

    <div>
        <label for="password">Password:</label>
        <input 
            type="password" 
            id="password" 
            name="password" 
            required 
            minlength="8" 
            maxlength="128"
            autocomplete="new-password"
        >
        <small>Must be at least 8 characters long and include uppercase, lowercase, number, and special character</small>
    </div>

    <button type="submit">Register</button>
</form>

<div class="nav">
    <p>Already have an account? <a href="/login">Login here</a></p>
</div>

<script>
// Client-side validation
document.querySelector('form').addEventListener('submit', function(e) {
    const username = document.getElementById('username').value;
    const password = document.getElementById('password').value;
    const email = document.getElementById('email').value;

    // Username validation
    if (!/^[a-zA-Z0-9_-]+$/.test(username)) {
        e.preventDefault();
        alert('Username can only contain letters, numbers, hyphens, and underscores');
        return;
    }

    if (username.length < 3 || username.length > 30) {
        e.preventDefault();
        alert('Username must be 3-30 characters long');
        return;
    }

    // Password validation
    if (password.length < 8 || password.length > 128) {
        e.preventDefault();
        alert('Password must be 8-128 characters long');
        return;
    }

    if (!/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]/.test(password)) {
        e.preventDefault();
        alert('Password must contain at least one uppercase letter, one lowercase letter, one number, and one special character');
        return;
    }

    // Email validation
    if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
        e.preventDefault();
        alert('Please enter a valid email address');
        return;
    }
});
</script> 